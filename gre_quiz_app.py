{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3346ac23",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2025-11-14 19:51:43.132 WARNING streamlit.runtime.caching.cache_data_api: No runtime found, using MemoryCacheStorageManager\n",
      "2025-11-14 19:51:43.149 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.149 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.208 \n",
      "  \u001b[33m\u001b[1mWarning:\u001b[0m to view this Streamlit app on a browser, run it with the following\n",
      "  command:\n",
      "\n",
      "    streamlit run /opt/anaconda3/lib/python3.13/site-packages/ipykernel_launcher.py [ARGUMENTS]\n",
      "2025-11-14 19:51:43.208 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.208 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.208 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.209 No runtime found, using MemoryCacheStorageManager\n",
      "2025-11-14 19:51:43.209 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.209 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.209 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.436 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.436 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.436 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.436 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.436 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.437 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.437 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.437 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.437 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.438 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.438 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.438 Session state does not function when running a script without `streamlit run`\n",
      "2025-11-14 19:51:43.438 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.439 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.439 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.439 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.439 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.439 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.440 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.440 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.440 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.440 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.441 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.441 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.441 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-11-14 19:51:43.441 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n"
     ]
    }
   ],
   "source": [
    "import streamlit as st\n",
    "import pandas as pd\n",
    "\n",
    "EXCEL_FILE = \"gre_words.xlsx\"  # ê°™ì€ í´ë”ì— ìˆëŠ” ì—‘ì…€ íŒŒì¼ ì´ë¦„\n",
    "\n",
    "\n",
    "# ===== ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° =====\n",
    "@st.cache_data\n",
    "def load_words(file_path):\n",
    "    df = pd.read_excel(file_path)\n",
    "    df = df.iloc[:, :2].dropna()   # ì•ì˜ ë‘ ì»¬ëŸ¼ë§Œ ì‚¬ìš© (ë‹¨ì–´, ëœ»)\n",
    "    df.columns = [\"word\", \"meaning\"]\n",
    "    return df.reset_index(drop=True)\n",
    "\n",
    "\n",
    "def is_correct(user_answer: str, correct_meaning: str) -> bool:\n",
    "    \"\"\"ì‚¬ìš©ì ë‹µì´ ì •ë‹µ ì˜ë¯¸ì™€ 'ëŒ€ì¶©' ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸ (ê³µë°±/ëŒ€ì†Œë¬¸ì ë¬´ì‹œ).\"\"\"\n",
    "    def norm(s):\n",
    "        return \"\".join(str(s).lower().split())\n",
    "\n",
    "    ua = norm(user_answer)\n",
    "    cm = norm(correct_meaning)\n",
    "\n",
    "    if not ua:\n",
    "        return False\n",
    "\n",
    "    # ì‚¬ìš©ìê°€ ì“´ ë‹µì´ ì •ë‹µì— í¬í•¨ë˜ê±°ë‚˜, ì •ë‹µì´ ì‚¬ìš©ìì˜ ë‹µì— í¬í•¨ë˜ë©´ ì •ë‹µ ì²˜ë¦¬\n",
    "    return ua in cm or cm in ua\n",
    "\n",
    "\n",
    "# ===== ì„¸ì…˜ ì´ˆê¸°í™” í•¨ìˆ˜ =====\n",
    "def init_quiz_state(df, n_questions: int):\n",
    "    st.session_state.quiz_df = df.sample(n_questions).reset_index(drop=True)\n",
    "    st.session_state.current_idx = 0\n",
    "    st.session_state.score = 0\n",
    "    st.session_state.finished = False\n",
    "    st.session_state.last_feedback = None  # (correct(bool), correct_meaning(str))\n",
    "\n",
    "\n",
    "# ===== ë©”ì¸ ì•± =====\n",
    "def main():\n",
    "    st.set_page_config(page_title=\"GRE ë‹¨ì–´ í€´ì¦ˆ\", page_icon=\"ğŸ“š\", layout=\"centered\")\n",
    "\n",
    "    st.title(\"ğŸ“š GRE ë‹¨ì–´ í€´ì¦ˆ\")\n",
    "    st.caption(\"ì—‘ì…€ì— ì €ì¥ëœ ë‹¨ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëœë¤ í€´ì¦ˆë¥¼ í’€ì–´ë³´ì„¸ìš”!\")\n",
    "\n",
    "    # ì—‘ì…€ ë¡œë”©\n",
    "    try:\n",
    "        df = load_words(EXCEL_FILE)\n",
    "    except FileNotFoundError:\n",
    "        st.error(f\"ì—‘ì…€ íŒŒì¼ `{EXCEL_FILE}` ì„(ë¥¼) ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. \"\n",
    "                 \"ë™ì¼í•œ í´ë”ì— íŒŒì¼ì„ ì €ì¥í–ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.\")\n",
    "        return\n",
    "    except Exception as e:\n",
    "        st.error(f\"ì—‘ì…€ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}\")\n",
    "        return\n",
    "\n",
    "    st.success(f\"í˜„ì¬ {len(df)}ê°œì˜ ë‹¨ì–´ë¥¼ ë¶ˆëŸ¬ì™”ì–´ìš”.\")\n",
    "\n",
    "    # ì™¼ìª½ì€ ì„¤ì •, ì˜¤ë¥¸ìª½ì€ ì„¤ëª…\n",
    "    col1, col2 = st.columns([2, 1])\n",
    "\n",
    "    with col1:\n",
    "        n_default = 30 if len(df) >= 30 else len(df)\n",
    "        n_questions = st.number_input(\n",
    "            \"í•œ ì„¸íŠ¸ì— í’€ ë¬¸ì œ ê°œìˆ˜\",\n",
    "            min_value=1,\n",
    "            max_value=len(df),\n",
    "            value=n_default,\n",
    "            step=1,\n",
    "            help=\"ëœë¤ìœ¼ë¡œ ì´ ê°œìˆ˜ë§Œí¼ ë½‘ì•„ì„œ ë¬¸ì œë¥¼ ë§Œë“¤ì–´ìš”.\",\n",
    "        )\n",
    "\n",
    "        if st.button(\"ğŸ¯ í€´ì¦ˆ ì‹œì‘í•˜ê¸°\", type=\"primary\"):\n",
    "            init_quiz_state(df, n_questions)\n",
    "            st.experimental_rerun()\n",
    "\n",
    "    with col2:\n",
    "        st.markdown(\n",
    "            \"\"\"\n",
    "            **ì‚¬ìš© ë°©ë²•**\n",
    "            1. `gre_words.xlsx` íŒŒì¼ì„ ê°™ì€ í´ë”ì— ë‘¡ë‹ˆë‹¤.  \n",
    "            2. í’€ê³  ì‹¶ì€ ë¬¸ì œ ê°œìˆ˜ë¥¼ ì •í•˜ê³  **í€´ì¦ˆ ì‹œì‘í•˜ê¸°**ë¥¼ ëˆ„ë¦…ë‹ˆë‹¤.  \n",
    "            3. ë‹¨ì–´ì˜ ëœ»ì„ ì…ë ¥í•˜ê³  ì œì¶œí•˜ë©´ ì •ë‹µ ì—¬ë¶€ê°€ ëœ¹ë‹ˆë‹¤.  \n",
    "            4. í•œ ì„¸íŠ¸ê°€ ëë‚˜ë©´ ì ìˆ˜ê°€ ìš”ì•½ë©ë‹ˆë‹¤.\n",
    "            \"\"\"\n",
    "        )\n",
    "\n",
    "    # ì•„ì§ í€´ì¦ˆ ì‹œì‘ ì „ì´ë©´ ì—¬ê¸°ì„œ ë\n",
    "    if \"quiz_df\" not in st.session_state or st.session_state.finished:\n",
    "        st.markdown(\"---\")\n",
    "        st.info(\"ìœ„ì—ì„œ **ë¬¸í•­ ìˆ˜ë¥¼ ì •í•œ ë’¤ í€´ì¦ˆë¥¼ ì‹œì‘**í•´ì£¼ì„¸ìš”.\")\n",
    "        return\n",
    "\n",
    "    quiz_df = st.session_state.quiz_df\n",
    "    idx = st.session_state.current_idx\n",
    "    total = len(quiz_df)\n",
    "\n",
    "    st.markdown(\"---\")\n",
    "\n",
    "    # ë°©ê¸ˆ ì „ ë¬¸ì œ í”¼ë“œë°±\n",
    "    if st.session_state.last_feedback is not None:\n",
    "        correct, correct_meaning = st.session_state.last_feedback\n",
    "        if correct:\n",
    "            st.success(\"âœ… ë°©ê¸ˆ ë¬¸ì œ: ì •ë‹µ!\")\n",
    "        else:\n",
    "            st.error(f\"âŒ ë°©ê¸ˆ ë¬¸ì œ: ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µ: `{correct_meaning}`\")\n",
    "\n",
    "    # ëª¨ë“  ë¬¸ì œë¥¼ ë‹¤ í’€ì—ˆìœ¼ë©´ ê²°ê³¼ë§Œ ë³´ì—¬ì£¼ê¸°\n",
    "    if idx >= total:\n",
    "        st.session_state.finished = True\n",
    "        score = st.session_state.score\n",
    "        st.markdown(\"## ğŸ‰ ì„¸íŠ¸ ì¢…ë£Œ!\")\n",
    "        st.write(f\"**ì ìˆ˜: {score} / {total}**  (ì •ë‹µë¥  {score/total*100:.1f}%)\")\n",
    "\n",
    "        if score / total >= 0.8:\n",
    "            st.success(\"ì¢‹ì•„ìš”! ì´ ì„¸íŠ¸ëŠ” ê½¤ ìµìˆ™í•´ì§„ ê²ƒ ê°™ì•„ìš” ğŸ˜\")\n",
    "        elif score / total >= 0.5:\n",
    "            st.info(\"ì ˆë°˜ ì´ìƒ ë§ì·„ì–´ìš”. í•œ ë²ˆ ë” ëŒë¦¬ë©´ ë” ìµìˆ™í•´ì§ˆ ê±°ì˜ˆìš” ğŸ’ª\")\n",
    "        else:\n",
    "            st.warning(\"ì¡°ê¸ˆ ì–´ë ¤ì› ì£ ? í‹€ë¦° ë¬¸ì œ ìœ„ì£¼ë¡œ ë‹¤ì‹œ ë³´ëŠ” ê±¸ ì¶”ì²œí•´ìš” ğŸ“–\")\n",
    "\n",
    "        if st.button(\"ğŸ” ìƒˆë¡œìš´ ì„¸íŠ¸ë¡œ ë‹¤ì‹œ í’€ê¸°\"):\n",
    "            init_quiz_state(df, total)\n",
    "            st.experimental_rerun()\n",
    "        return\n",
    "\n",
    "    # ===== í˜„ì¬ ë¬¸ì œ í‘œì‹œ =====\n",
    "    row = quiz_df.iloc[idx]\n",
    "    word = row[\"word\"]\n",
    "    meaning = row[\"meaning\"]\n",
    "\n",
    "    st.subheader(f\"ë¬¸ì œ {idx + 1} / {total}\")\n",
    "    st.markdown(f\"### âœ… ë‹¨ì–´: **{word}**\")\n",
    "\n",
    "    with st.form(key=f\"quiz_form_{idx}\"):\n",
    "        user_answer = st.text_input(\"ì´ ë‹¨ì–´ì˜ ëœ»ì„ ì ì–´ë³´ì„¸ìš”\", key=f\"answer_{idx}\")\n",
    "        submitted = st.form_submit_button(\"ì œì¶œ\")\n",
    "\n",
    "    if submitted:\n",
    "        correct = is_correct(user_answer, meaning)\n",
    "        if correct:\n",
    "            st.session_state.score += 1\n",
    "\n",
    "        # ë°©ê¸ˆ ë¬¸ì œì— ëŒ€í•œ í”¼ë“œë°± ì €ì¥\n",
    "        st.session_state.last_feedback = (correct, meaning)\n",
    "        # ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™\n",
    "        st.session_state.current_idx += 1\n",
    "        st.experimental_rerun()\n",
    "\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    main()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "71ab6015",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
